{% extends "base.html" %}

{% block titulo %}üßçVISITANTES {% endblock %} 

{% load static %}

{% block contenido %}

                        <!-- Filtros avanzados -->
                        <div class="card mb-4">
                        <div class="card-body">
                            <form method="get" id="filtro-form" class="d-flex flex-wrap gap-2 align-items-center justify-content-end">

                            <!-- B√∫squeda general -->
                            <input type="text" name="q" class="form-control form-control-sm" placeholder="Buscar..." value="{{ query }}" style="max-width: 200px;">

                            <!-- Selector de campo -->
                            <select id="campo-select" class="form-select form-select-sm" style="max-width: 160px;">
                                <option selected disabled>Filtrar por campo</option>
                                <option value="accion">Accion</option>
                            </select>

                            <!-- Input para valor -->
                            <input type="text" id="campo-valor" class="form-control form-control-sm" placeholder="Valor..." style="max-width: 160px;">

                            <!-- Bot√≥n para agregar filtro -->
                            <button type="button" class="btn btn-sm btn-outline-primary" onclick="agregarFiltro()">Agregar filtro</button>

                            <!-- Filtro por fecha -->
                            <div class="d-flex align-items-center gap-2 mt-2">
                                <label class="form-label mb-0">Desde:</label>
                                <input type="date" name="desde" class="form-control form-control-sm" value="{{ desde }}" style="max-width: 150px;">
                                
                                <label class="form-label mb-0">Hasta:</label>
                                <input type="date" name="hasta" class="form-control form-control-sm" value="{{ hasta }}" style="max-width: 150px;">
                            </div>

                            <!-- Etiquetas de filtros activos -->
                            <div id="filtros-activos" class="d-flex flex-wrap gap-2 mt-3"></div>

                            <!-- Bot√≥n de b√∫squeda -->
                            <button type="submit" class="btn btn-sm btn-primary mt-2">Filtrar</button>
                            </form>
                        </div>
                        </div>

<!--========================================================================================================================================-->

    <table class="table">
        <thead>
            <h4 class="text-center"></i>REGISTRO AUDITORIA</h5>
            <tr>
                <th>FECHA</th>
                <th>USUARIO</th>
                <th>ACCION</th>
                <th>VISITANTE</th>
                <th>DETALLES</th>
            </tr>
        </thead>

        <tbody>

            {% for registro in registros %}
            <tr>
                <td>{{ registro.fecha_hora }}</td>
                <td>{% if registro.usuario %}
                        {{ registro.usuario.nombre }}
                    {% else %}
                        Sin usuario
                    {% endif %}
                </td>
                <td>{{ registro.accion }}</td>
                <td>{{ registro.visita.nombre }} {{ registro.visita.apellido }}</td>
                <td>{{ registro.detalles }}</td>
            </tr>
            {% endfor %}

        </tbody>

    </table>
{% endblock %}